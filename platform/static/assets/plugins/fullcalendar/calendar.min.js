$.fn.calendar=function(t){"use strict";return this.each(function(){function e(t,e){var a=t%4===0&&t%100!==0||t%400===0?29:28,s=[31,a,31,30,31,30,31,31,30,31,30,31];return s[e]}function a(t,e){var a=[];return t&&$.each(t,function(){e.getTime()>=this.start.getTime()&&e.getTime()<=this.end.getTime()&&a.push(this)}),a||!1}var s={color:!1,months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysMin:["SUN","MON","TUE","WED","THU","FRI","SAT"],dayLetter:["S","M","T","W","T","F","S"],events:!1};t=t||{};var r=$.extend(s,t);r.events&&$.each(r.events,function(t,e){e.start=new Date(e.start),e.start.setHours(0,0,0,0),e.end=new Date(e.end),e.end.setHours(0,0,0,0),r.events[t]=e});var n;n=r.date?new Date(r.date):new Date($(this).data("date")),isNaN(n.valueOf())&&(n=new Date),n.setDate(1),n.setHours(0,0,0,0);var d=n,i=new Date;i.setHours(0,0,0,0);var h,o=e(n.getFullYear(),n.getMonth()),u=$("<thead/>").append($("<tr/>").addClass("calendar-title").append($("<th/>").attr("colspan",7).text(r.months[n.getMonth()]+" "+n.getFullYear()))).append($("<tr/>").addClass("calendar-header").html("<th>"+r.daysMin.join("</th><th>")+"</th>")),m="<tbody><tr>";for(h=0;h<n.getDay();h+=1)m+='<td class="pad"> </td>';for(var c,l,g,y,v=1;v<=o;)g=a(r.events,d),c=d.getTime()===i.getTime()?" today":"",l="",y=" ",g&&$.each(g,function(){this.start.getTime()===d.getTime()?(l+=this.mask?" mask-start":"",l+=this.classes?" "+this.classes:"",y+=this.summary||""):d.getTime()>this.start.getTime()&&d.getTime()<this.end.getTime()?l+=this.mask?" mask":"":d.getTime()===this.end.getTime()&&(l+=this.mask?" mask-end":"")}),m+='<td class="day'+l+c+'" title="'+y+'">',m+="<div>"+d.getDate()+"</div>",m+="<div>"+y+"</div>",m+="</td>",6===d.getDay()&&(m+="</tr>",v+1<=o&&(m+="<tr>")),d.setDate(n.getDate()+1),v+=1;var T=7-d.getDay();if(T&&T<7)for(h=1;h<=T;h+=1)m+='<td class="pad"> </td>';var p="";r.color&&(p=r.color),$(this).html($("<table/>").addClass("calendar "+p).append(u).append(m))})};